C51 COMPILER V9.01   FIRESENSOR                                                            02/25/2017 10:39:28 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE FIRESENSOR
OBJECT MODULE PLACED IN .\hex\firesensor.obj
COMPILER INVOKED BY: D:\Keil_C51\C51\BIN\C51.EXE fireSensor\firesensor.c BROWSE INCDIR(.\motor;.\trace;.\fireSensor) DEB
                    -UG OBJECTEXTEND PRINT(.\firesensor.lst) OBJECT(.\hex\firesensor.obj)

line level    source

   1          #include <reg52.h>
   2          #include "firesensor.h"
   3          #include "motor.h"
   4          //sbit fireSensor[5]={1,1,1,1,1};
   5          sfr fireSensor=0XA0;                    //P2端口(火焰传感器)的地址
   6          sbit angleMotor=P1^2;
   7          //从左到右 P20 P21 P22 P23 P24
   8          sbit sersor0=P2^0;
   9          sbit sersor1=P2^1;
  10          sbit sersor2=P2^2;
  11          sbit sersor3=P2^3;
  12          sbit sersor4=P2^4;
  13          
  14          char fireFlag=-1;
  15          
  16          uint fireSensorAngle[]={14,12,10,8,6};     //数值方案暂定       2.25 9:35
  17          
  18          
  19          extern int angle;                                                       //在main中定义
  20          
  21          uint checkFire(void)    
  22          {
  23   1              static char fire[5];
  24   1              char i;
  25   1              uint angle;
  26   1              char fs;
  27   1              fs=fireSensor;
  28   1              fs=~fs;                                                                 //有火焰是低电平，进行反转
  29   1              for(i=0;i<5;i++)
  30   1              {
  31   2                      fire[i]=(char)((fs>>i)&0X01);
  32   2                      if(fire[i])
  33   2                      {
  34   3                              angle=fireSensorAngle[i];
  35   3                              fireFlag=i;                                             //用来设置角度舵机转动的角度
  36   3                              motorAction(STOP,0);                    //小车轮子别动                  
  37   3                              return angle;
  38   3                      }
  39   2              }
  40   1              fireFlag=-1;
  41   1              return fireSensorAngle[2];                              //如果没有火焰则风扇正对中间      
  42   1      }
  43          
  44          void initAngleMotor(void)
  45          {
  46   1              TMOD&=0XF0;
  47   1              TMOD|=0X01;                                                             //定时器0 16位定时器
  48   1              TR0=1;
  49   1              ET0=1;
  50   1              EA=1;
  51   1      }
  52          
  53          //void killFire(void)
  54          //{     
C51 COMPILER V9.01   FIRESENSOR                                                            02/25/2017 10:39:28 PAGE 2   

  55          //      
  56          //      switch(fireFlag)
  57          //      {
  58          //       case 0:/*调整角度，打开继电器*/break;
  59          //       case 1:/*调整角度，打开继电器*/break;
  60          //       case 2:/*调整角度，打开继电器*/break;
  61          //       case 3:/*调整角度，打开继电器*/break;
  62          //       case 4:/*调整角度，打开继电器*/break;
  63          //       default :/*调整角度，关闭继电器*/break;
  64          //      }
  65          //}


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    101    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     16       4
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
