C51 COMPILER V9.01   MAIN                                                                  02/24/2017 17:46:33 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\hex\main.obj
COMPILER INVOKED BY: D:\Keil_C51\C51\BIN\C51.EXE main.c BROWSE INCDIR(.\motor;.\trace;.\fireSensor) DEBUG OBJECTEXTEND O
                    -BJECT(.\hex\main.obj)

line level    source

   1          #include <reg52.h>
   2          #include "motor.h"
   3          #include "trace.h"
   4          #include "firesensor.h"
   5          
   6          #define NUM 1
   7          int angle;
   8          bit pwmFlag=0;
   9          sbit beep=P2^3;
  10          sbit angleMotor=P1^2;
  11          
  12          extern uint fireSensorAngle[5];
  13          void delayms(uint xms)
  14          {
  15   1       uint i,j;
  16   1       for(i=xms;i>0;i--)
  17   1              for(j=110;j>0;j--);
  18   1      }
  19          
  20          void main(void)         
  21          {
  22   1              //initWheelMotor();
  23   1              delayms(2);
  24   1              initAngleMotor();
  25   1              delayms(2);
  26   1              angle=fireSensorAngle[0];
  27   1              
  28   1              while(1)
  29   1              {
  30   2               //trace();
  31   2              }
  32   1      }
  33          
  34          void Tim1forWheel(void) interrupt 3                     //两个轮子
  35          {
  36   1              EA=0;
  37   1              wheelMotorInterrupt();
  38   1              EA=1;
  39   1      }
  40          
  41          void Tim0forAngleMotor(void) interrupt 1
  42          {
  43   1              
  44   1              EA=0;
  45   1              if(pwmFlag)
  46   1              {
  47   2                      pwmFlag=0;
  48   2                      angleMotor=1;
  49   2                      TH0=(65536-(fireSensorAngle[NUM]))/256;                 //高电平时间
  50   2                      TL0=(65526-(fireSensorAngle[NUM]))%256;
  51   2                      //angleMotorInterrupt(angle,pwmFlag);
  52   2                      //beep=pwmFlag=0;
  53   2              }
  54   1              else
C51 COMPILER V9.01   MAIN                                                                  02/24/2017 17:46:33 PAGE 2   

  55   1              {
  56   2                      pwmFlag=1;
  57   2                      angleMotor=0;
  58   2                      TH0=(65536-(18349+fireSensorAngle[NUM]))/256;   //低电平时间
  59   2                      TL0=(65536-(18349+fireSensorAngle[NUM]))%256;
  60   2                      //angleMotorInterrupt(18349-angle,pwmFlag);                     //18349是20ms           
  61   2                      //beep=pwmFlag=1;
  62   2              }
  63   1              EA=1;
  64   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    320    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
